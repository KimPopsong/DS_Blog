---
title: "TODO: 여행 추천 플랫폼"
pubDate: 2025-05-28T00:00+09:00
startDate: 2025-04-01
endDate: 2025-05-28
description: "여행지 추천 플랫폼"
thumbnail: '../../assets/projects/todo/TODO_Hero.webp'
heroImage: '../../assets/projects/todo/TODO_Hero.webp'
gitHub: "https://github.com/KimPopsong/SSAFY-Through-Project"
teamSize: "3명"
tags: ["Spring Boot", "MySQL", "JPA", "AWS", "Redis", "Prometheus", "Grafana", "k6"]
---

## **1. 사용 기술**

### **1.1. Backend**

- **Java 17**
- **Spring Boot 3.2.5**
- **Spring AI:** LLM(Large Language Model)을 활용한 AI 기능 구현
- **Spring Security:** JWT 기반 인증 및 인가
- **Spring Data JPA:** 데이터베이스 연동
- **MySQL 8.0:** 주 데이터베이스
- **Redis:** 실시간 데이터 처리 및 캐싱 (JWT, 채팅 등)
- **MyBatis:** 유연한 SQL 쿼리 관리
- **WebSocket (STOMP):** 실시간 양방향 통신 (채팅)

### **1.2. Frontend**

- **Vue.js 3**
- **Vite**
- **Pinia:** 상태 관리
- **Axios:** HTTP 통신
- **Tailwind CSS:** UI 스타일링

### **1.3. DevOps**

- **Git, GitHub:** 버전 관리 및 협업
- **Docker, Docker Compose:** 컨테이너 기반 배포 및 관리
- **Jenkins:** CI/CD 파이프라인 구축
- **NGINX:** 리버스 프록시 및 로드 밸런싱
- **AWS (EC2, S3, RDS):** 클라우드 인프라 활용

## **2. 세부 구성도**

![세부구성도](../../assets/projects/todo/TODO_Architecture.webp)

## **3. 아키텍처 구조**

TODO 프로젝트는 MSA(Microservice Architecture)를 기반으로 설계되었습니다. 각 서비스는 독립적으로 개발, 배포, 확장이 가능하여 유연하고 안정적인 시스템 운영을 보장합니다.

### **3.1. 주요 서비스**

- **User Service:** 회원 가입, 로그인, 프로필 관리 등 사용자 관련 기능을 담당합니다.
- **Attraction Service:** 관광지 정보 조회, 검색, 추천 등 여행지 관련 기능을 담당합니다.
- **Post Service:** 게시판, 댓글, 추천 등 커뮤니티 관련 기능을 담당합니다.
- **Product Service:** 판매자 상품 등록, 수정, 삭제 등 상품 관련 기능을 담당합니다.
- **Reservation Service:** 상품 예약 및 결제 관련 기능을 담당합니다.
- **Chat Service:** 사용자-판매자 간 실시간 채팅 기능을 담당합니다.
- **Admin Service:** 관리자 기능(회원 관리, 판매자 승인 등)을 담당합니다.

### **3.2. 데이터베이스 설계**

각 서비스는 독립적인 데이터베이스를 사용하여 서비스 간 결합도를 낮추고 데이터 관리의 효율성을 높입니다.

## **4. 구현 내용**

### **4.1. 인증 및 인가 (Spring Security & JWT)**

- **`SecurityConfig`:** Spring Security의 핵심 설정 파일입니다. HTTP 요청에 대한 보안 규칙, 필터 체인, 인증 및 인가 처리 방식 등을 정의합니다.
    - `filterChain()`: HTTP 요청에 대한 보안 필터 체인을 설정합니다. `JWTAuthenticationFilter`를 등록하여 모든 요청에 대해 JWT 토큰을 검증합니다.
    - `corsConfigurationSource()`: CORS(Cross-Origin Resource Sharing) 설정을 통해 다른 도메인에서의 요청을 허용합니다.
- **`JWTAuthenticationFilter`:** 클라이언트의 모든 요청을 가로채 헤더에 포함된 JWT 토큰의 유효성을 검증합니다.
    - 토큰이 유효하면 `SecurityContextHolder`에 인증 정보를 저장하여 해당 요청이 인증된 사용자의 요청임을 명시합니다.
- **`JWTService`:** JWT 토큰의 생성, 검증, 파싱 등 JWT 관련 모든 로직을 처리합니다.
    - `generateToken()`: 사용자 정보를 기반으로 JWT 토큰을 생성합니다.
    - `validateToken()`: 토큰의 유효 기간, 서명 등을 검증합니다.
    - `getEmailFromToken()`: 토큰에서 사용자 이메일 정보를 추출합니다.
- **`AuthController`:** 로그인, 회원가입 등 인증 관련 API 엔드포인트를 제공합니다.
    - `/login`: 사용자로부터 이메일과 비밀번호를 받아 로그인을 처리하고, 성공 시 JWT 토큰을 발급합니다.
    - `/regist-member`: 회원가입 요청을 처리합니다.

### **4.2. AI 기반 관광지 추천 (Spring AI & VectorStore)**

- **`AttractionDataMigrator`:** 프로젝트 시작 시, 데이터베이스의 관광지 정보를 VectorStore(Redis)에 벡터 형태로 저장하는 역할을 합니다.
- **`AttractionsController`:** 관광지 관련 API 엔드포인트를 제공합니다.
    - `/similar`: 특정 관광지와 유사한 관광지를 추천해주는 API입니다.
- **`AttractionsServiceImpl`:** 관광지 추천 비즈니스 로직을 구현합니다.
    - `selectSimilarAttractions()`: 사용자가 선택한 관광지의 `overview`(소개) 텍스트를 기반으로 VectorStore에서 유사한 벡터를 가진 관광지들을 검색하여 반환합니다. Spring AI의 `VectorStore` 인터페이스를 통해 간단하게 유사도 검색을 수행할 수 있습니다.

### **4.3. 실시간 채팅 (WebSocket & STOMP & Redis)**

- **`WebSocketConfig`:** WebSocket 및 STOMP 관련 설정을 담당합니다.
    - `registerStompEndpoints()`: 클라이언트가 WebSocket 연결을 시작할 엔드포인트를 지정합니다. (`/ws`)
    - `configureMessageBroker()`: 메시지 브로커를 설정합니다.
        - `/topic`: 1:N 통신(채팅방)을 위한 경로
        - `/queue`: 1:1 통신을 위한 경로
        - `/app`: 클라이언트에서 서버로 메시지를 보낼 때 사용하는 경로
- **`ChatController`:** WebSocket 메시지를 처리하는 컨트롤러입니다.
    - `@MessageMapping("/chat/{roomId}")`: `/app/chat/{roomId}` 경로로 들어오는 메시지를 처리합니다.
    - `@SendTo("/topic/chat/{roomId}")`: 메시지 처리 후, 해당 채팅방을 구독하고 있는 모든 클라이언트에게 메시지를 브로드캐스팅합니다.
- **`ChatServiceImpl`:** 채팅 관련 비즈니스 로직을 구현합니다.
    - `insertMessage()`: 수신된 채팅 메시지를 데이터베이스(MySQL)에 저장하고, 동시에 Redis에도 저장하여 최근 메시지를 빠르게 조회할 수 있도록 합니다.
    - `getRecentMessagesFromRedis()`: 채팅방 입장 시, Redis에 캐시된 최근 메시지를 먼저 불러와 사용자에게 빠르게 보여줍니다.
    - `getMessagesByRoomIdPaged()`: Redis에 없는 과거 메시지는 데이터베이스에서 페이징 처리하여 조회합니다.

### **4.4. 게시판 및 커뮤니티**

- **`PostController`:** 게시글 작성, 조회, 수정, 삭제 및 댓글, 추천 관련 API를 제공합니다.
    - `GET /list`: 게시판 종류(`boardType`)에 따른 게시글 목록을 조회합니다.
    - `GET /detail/{id}`: 특정 게시글의 상세 내용을 조회하며, 조회수를 1 증가시킵니다.
    - `POST /write`: 새로운 게시글을 작성합니다. JWT 토큰에서 작성자 정보를 추출하여 저장합니다.
    - `PATCH /update/{postId}`: 기존 게시글을 수정합니다.
    - `DELETE /delete/{id}`: 게시글을 삭제합니다. 작성자 본인이거나 관리자만 삭제할 수 있습니다.
    - `POST /recommend/{id}`: 게시글을 추천/비추천합니다. 한 번만 참여할 수 있도록 중복을 체크합니다.
- **`PostServiceImpl`:** 게시판 관련 비즈니스 로직을 구현합니다.
    - `deletePost()`: 게시글 삭제 요청 시, 요청한 사용자가 작성자 본인인지 또는 관리자인지 권한을 확인한 후 삭제를 진행합니다.
    - `updateRecommendCount()`: 추천/비추천 요청 시, `recommendation` 테이블을 확인하여 이미 참여했는지 확인하고, 참여하지 않았을 경우에만 추천/비추천 수를 업데이트하고 참여 기록을 남깁니다.

### **4.5. 판매자 및 상품 관리**

- **`ProductController`:** 판매자의 상품 등록, 조회, 삭제 API를 제공합니다.
- **`ReservationController`:** 사용자의 상품 예약 생성 및 조회 API를 제공합니다.
- **`SellerRequestController`:** 사용자의 판매자 등록 신청 및 관리자의 승인/거절 API를 제공합니다.
- **`SellerServiceImpl`, `ProductServiceImpl`, `ReservationServiceImpl`:** 각 기능에 맞는 비즈니스 로직을 처리합니다.