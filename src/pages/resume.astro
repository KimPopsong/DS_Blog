---
import { getCollection, render } from 'astro:content';
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';

// Resume ë§ˆí¬ë‹¤ìš´ íŒŒì¼ ê°€ì ¸ì˜¤ê¸°
const resumeEntries = await getCollection('resume');
const resumeEntry = resumeEntries[0]; // ì²« ë²ˆì§¸ resume íŒŒì¼ ì‚¬ìš©

// í”„ë¡œì íŠ¸ ì»¬ë ‰ì…˜ ê°€ì ¸ì˜¤ê¸°
const allProjects = await getCollection('project');
const projectOrder = ['PICA', 'GOLDEN_TICKET', 'TODO', 'MERGE'];
const sortedProjects = projectOrder
	.map(id => allProjects.find(p => p.id === id || p.id.toLowerCase() === id.toLowerCase()))
	.filter(Boolean)
	.concat(allProjects.filter(p => !projectOrder.some(orderId => p.id === orderId || p.id.toLowerCase() === orderId.toLowerCase())));

// í”„ë¡œì íŠ¸ ë°ì´í„° ì¤€ë¹„ (ì´ë¯¸ì§€ URL í¬í•¨) - FOX_BOOK_FINDER ì œì™¸
	const projectsData = sortedProjects
		.filter(project => project.id !== 'FOX_BOOK_FINDER' && project.id.toLowerCase() !== 'fox_book_finder')
		.filter((project): project is NonNullable<typeof project> => project !== undefined)
		.map((project) => {
			let imageUrl = '';
			// thumbnailì´ ìˆìœ¼ë©´ thumbnail ìš°ì„  ì‚¬ìš©, ì—†ìœ¼ë©´ heroImage ì‚¬ìš©
			const imageSource = project.data.thumbnail || project.data.heroImage;
			if (imageSource) {
				// ì´ë¯¸ì§€ ê°ì²´ì—ì„œ src ì†ì„± ì¶”ì¶œ
				const image = imageSource;
				imageUrl = typeof image === 'object' && 'src' in image ? image.src : '';
			}
		return {
			id: project.id,
			title: project.data.title,
			description: project.data.description,
			pubDate: project.data.pubDate.toISOString(),
			startDate: project.data.startDate?.toISOString() || null,
			endDate: project.data.endDate?.toISOString() || null,
			tags: project.data.tags || [],
			imageUrl: imageUrl,
			url: `/project/${project.id}`
		};
	});

let Content;
if (resumeEntry) {
	const rendered = await render(resumeEntry);
	Content = rendered.Content;
}
---

<!doctype html>
<html lang="ko">
	<head>
		<BaseHead title={`Resume | ${SITE_TITLE}`} description={SITE_DESCRIPTION} />
		<style>
			body {
				margin: 0 !important;
				padding: 0 !important;
			}
			main {
				max-width: 1000px !important;
				width: 100% !important;
				margin-left: auto !important;
				margin-right: auto !important;
				margin-top: 0 !important;
				margin-bottom: 0 !important;
				padding: 4rem 2em !important;
				display: block !important;
				box-sizing: border-box !important;
				text-align: left !important;
				position: relative !important;
			}
			@media (max-width: 840px) {
				main {
					width: calc(100% - 4em) !important;
					max-width: calc(100% - 4em) !important;
				}
			}
			.resume-content {
				background: var(--card-bg);
				border: 1px solid var(--card-border);
				border-radius: 20px;
				padding: 4rem 4rem;
				box-shadow: var(--neon-glow), 0 20px 60px rgba(0, 0, 0, 0.5);
				width: 100%;
				box-sizing: border-box;
				margin: 0 auto;
				display: block;
			}
			.resume-content :global(h1) {
				font-size: 2.5rem;
				font-weight: 700;
				margin: 0 0 1rem 0;
				color: rgb(var(--black));
				line-height: 1.2;
			}
			.resume-content :global(blockquote) {
				margin: 1.5rem 0 3rem 0;
				padding: 0;
				border-left: none;
				font-size: 1.1rem;
				color: rgb(var(--gray-dark));
				line-height: 1.8;
				font-style: italic;
			}
			.resume-content :global(blockquote p) {
				margin: 0.5rem 0;
			}
			.resume-content :global(h2) {
				font-size: 1.5rem;
				font-weight: 600;
				margin: 1.25rem 0 0.75rem 0;
				color: rgb(var(--black));
				display: flex;
				align-items: center;
				gap: 0.5rem;
			}
			.resume-content :global(hr) {
				border: none;
				border-top: 1px solid var(--card-border);
				margin: 1.25rem 0;
			}
			.resume-content :global(h3) {
				font-size: 1.2rem;
				margin: 1.5rem 0 0.75rem 0;
				color: rgb(var(--black));
				font-weight: 600;
			}
			.resume-content :global(p) {
				font-size: 1rem;
				color: rgb(var(--gray-dark));
				line-height: 1.8;
				margin: 0.75rem 0;
			}
			.resume-content :global(strong) {
				font-weight: 600;
				color: rgb(var(--black));
			}
			.resume-content :global(ul), .resume-content :global(ol) {
				margin: 1rem 0;
				padding-left: 1.5rem;
			}
			.resume-content :global(li) {
				margin: 0.5rem 0;
				color: rgb(var(--gray-dark));
				line-height: 1.8;
				font-size: 1rem;
			}
			.resume-content :global(img) {
				border-radius: 12px;
				border: 1px solid var(--card-border);
				box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
			}
			/* í”„ë¡œí•„ ì„¹ì…˜ ë ˆì´ì•„ì›ƒ */
			.resume-content :global(.profile-container) {
				display: flex;
				gap: 2rem;
				align-items: flex-start;
				margin: 2rem 0;
			}
			.resume-content :global(.profile-image) {
				flex-shrink: 0;
			}
			.resume-content :global(.profile-info) {
				flex: 1;
			}
			.resume-content :global(.profile-info > p:first-child) {
				margin-top: 0 !important;
			}
			.resume-content :global(.profile-info > p:first-child:has(strong)) {
				margin-top: 0 !important;
			}
			/* Profile ì •ë³´ ê°„ê²© ì¤„ì´ê¸° - ì‚¬ì§„ ë†’ì´ì— ë§ì¶”ê¸° */
			.resume-content :global(.profile-info p:has(strong)) {
				margin-top: 0.5rem !important;
				margin-bottom: 0.25rem !important;
			}
			.resume-content :global(.profile-info p:has(strong) + p) {
				margin-top: 0 !important;
				margin-bottom: 0.5rem !important;
			}
			/* Activities ì„¹ì…˜ ë ˆì´ì•„ì›ƒ */
			.resume-content :global(.activities-container) {
				display: flex;
				flex-direction: column;
				gap: 1.5rem;
				margin: 2rem 0;
			}
			.resume-content :global(.activity-item) {
				display: flex;
				gap: 2rem;
				align-items: baseline;
				margin-bottom: 0;
			}
			.resume-content :global(.activity-left) {
				flex: 1;
			}
			.resume-content :global(.activity-right) {
				flex: 1;
			}
			.resume-content :global(.activity-left > p:first-child) {
				margin-top: 0 !important;
				margin-bottom: 0 !important;
				line-height: 1.8;
			}
			.resume-content :global(.activity-right > ul) {
				margin-top: 0;
				margin-bottom: 0;
				padding-top: 0;
				padding-left: 1.5rem;
			}
			.resume-content :global(.activity-right > ul > li:first-child) {
				margin-top: 0;
			}
			/* Awards ì„¹ì…˜ ë ˆì´ì•„ì›ƒ */
			.resume-content :global(.awards-container) {
				display: flex;
				flex-direction: column;
				gap: 1.5rem;
				margin: 2rem 0;
			}
			.resume-content :global(.awards-item) {
				display: flex;
				gap: 2rem;
				align-items: baseline;
				margin-bottom: 0;
			}
			.resume-content :global(.awards-left) {
				flex: 1;
			}
			.resume-content :global(.awards-right) {
				flex: 1;
			}
			.resume-content :global(.awards-left > p:first-child) {
				margin-top: 0 !important;
				margin-bottom: 0 !important;
				line-height: 1.8;
			}
			.resume-content :global(.awards-right > ul) {
				margin-top: 0;
				margin-bottom: 0;
				padding-top: 0;
				padding-left: 1.5rem;
			}
			.resume-content :global(.awards-right > ul > li:first-child) {
				margin-top: 0;
			}
			/* Certifications ì„¹ì…˜ ë ˆì´ì•„ì›ƒ */
			.resume-content :global(.certifications-container) {
				display: flex;
				flex-direction: column;
				gap: 1.5rem;
				margin: 2rem 0;
			}
			.resume-content :global(.certification-item) {
				display: flex;
				gap: 2rem;
				align-items: baseline;
				margin-bottom: 0;
			}
			.resume-content :global(.certification-left) {
				flex: 1;
			}
			.resume-content :global(.certification-right) {
				flex: 1;
			}
			.resume-content :global(.certification-left > p:first-child) {
				margin-top: 0 !important;
				margin-bottom: 0 !important;
				line-height: 1.8;
			}
			.resume-content :global(.certification-right > ul) {
				margin-top: 0;
				margin-bottom: 0;
				padding-top: 0;
				padding-left: 1.5rem;
			}
			.resume-content :global(.certification-right > ul > li:first-child) {
				margin-top: 0;
			}
			/* Educations ì„¹ì…˜ ë ˆì´ì•„ì›ƒ */
			.resume-content :global(.educations-container) {
				display: flex;
				flex-direction: column;
				gap: 1.5rem;
				margin: 2rem 0;
			}
			.resume-content :global(.education-item) {
				display: flex;
				gap: 2rem;
				align-items: baseline;
				margin-bottom: 0;
			}
			.resume-content :global(.education-left) {
				flex: 1;
			}
			.resume-content :global(.education-right) {
				flex: 1;
			}
			.resume-content :global(.education-left > p:first-child) {
				margin-top: 0 !important;
				margin-bottom: 0 !important;
				line-height: 1.8;
			}
			.resume-content :global(.education-right > ul) {
				margin-top: 0;
				margin-bottom: 0;
				padding-top: 0;
				padding-left: 1.5rem;
			}
			.resume-content :global(.education-right > ul > li:first-child) {
				margin-top: 0;
			}
			/* ETC ì„¹ì…˜ ë ˆì´ì•„ì›ƒ */
			.resume-content :global(.etc-container) {
				display: flex;
				flex-direction: column;
				gap: 1.5rem;
				margin: 2rem 0;
			}
			.resume-content :global(.etc-item) {
				display: flex;
				gap: 2rem;
				align-items: baseline;
				margin-bottom: 0;
			}
			.resume-content :global(.etc-left) {
				flex: 1;
			}
			.resume-content :global(.etc-right) {
				flex: 1;
			}
			.resume-content :global(.etc-left > p:first-child) {
				margin-top: 0 !important;
				margin-bottom: 0 !important;
				line-height: 1.8;
			}
			.resume-content :global(.etc-right > ul) {
				margin-top: 0;
				margin-bottom: 0;
				padding-top: 0;
				padding-left: 1.5rem;
			}
			.resume-content :global(.etc-right > ul > li:first-child) {
				margin-top: 0;
			}
			/* Skills and Tools ì„¹ì…˜ ë ˆì´ì•„ì›ƒ */
			.resume-content :global(.skills-container) {
				display: flex;
				flex-direction: column;
				gap: 0.5rem;
				margin: 2rem 0;
			}
			.resume-content :global(.skill-category) {
				display: flex;
				flex-direction: column;
				gap: 0.5rem;
			}
			.resume-content :global(.skill-category h3) {
				font-size: 1.1rem;
				font-weight: 600;
				margin: 0 0 0.25rem 0;
				color: rgb(var(--black));
				border-bottom: 1px solid var(--card-border);
				padding-bottom: 0.25rem;
			}
			.resume-content :global(.skill-item) {
				display: flex;
				flex-direction: row;
				align-items: center;
				justify-content: space-between;
				gap: 1rem;
				margin-bottom: 0;
				padding: 0.4rem 0.75rem;
				background: rgba(79, 140, 255, 0.03);
				border: 1px solid var(--card-border);
				border-radius: 6px;
			}
			.resume-content :global(.skill-name) {
				font-weight: 600;
				color: var(--accent-glow);
				font-size: 1rem;
				flex-shrink: 0;
			}
			.resume-content :global(.skill-rating) {
				display: flex;
				gap: 0.15rem;
				align-items: center;
				flex-shrink: 0;
			}
			.resume-content :global(.skill-rating .star) {
				font-size: 1rem;
				color: var(--accent);
				line-height: 1;
			}
			.resume-content :global(.skill-rating .star.filled) {
				color: var(--accent-glow);
				text-shadow: 0 0 6px rgba(107, 163, 255, 0.4);
			}
			.resume-content :global(.skills-description) {
				margin-top: 1.5rem;
				padding: 1.25rem;
				background: rgba(79, 140, 255, 0.05);
				border: 1px solid var(--card-border);
				border-radius: 8px;
			}
			.resume-content :global(.skills-description ul) {
				margin: 0;
				padding-left: 1.5rem;
				list-style-type: disc;
			}
			.resume-content :global(.skills-description li) {
				margin: 0.5rem 0;
				color: rgb(var(--gray-dark));
				line-height: 1.7;
				font-size: 0.95rem;
			}
			.resume-content :global(.skills-description li:first-child) {
				margin-top: 0;
			}
			.resume-content :global(.skills-description li:last-child) {
				margin-bottom: 0;
			}
			/* Projects ì„¹ì…˜ ë ˆì´ì•„ì›ƒ - ê·¸ë¦¬ë“œ ì¹´ë“œ í˜•ì‹ */
			.resume-content :global(.projects-container) {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
				gap: 2rem;
				margin: 2rem 0;
			}
			.resume-content :global(.project-card) {
				background: var(--card-bg);
				border: 1px solid var(--card-border);
				border-radius: 20px;
				overflow: hidden;
				box-shadow: var(--neon-glow), 0 20px 60px rgba(0, 0, 0, 0.5);
				transition: all 0.3s ease;
				text-decoration: none;
				color: inherit;
				display: flex;
				flex-direction: column;
			}
			.resume-content :global(.project-card:hover) {
				transform: translateY(-5px);
				box-shadow: var(--neon-glow), 0 25px 70px rgba(79, 140, 255, 0.3);
				border-color: var(--accent);
			}
			.resume-content :global(.project-card-image) {
				width: 100%;
				height: 200px;
				overflow: hidden;
				background: var(--card-bg);
			}
			.resume-content :global(.project-card-image img) {
				width: 100%;
				height: 100%;
				object-fit: cover;
			}
			.resume-content :global(.project-card-content) {
				padding: 1.5rem;
				display: flex;
				flex-direction: column;
				gap: 0.75rem;
				flex: 1;
			}
			.resume-content :global(.project-card-title) {
				font-size: 1.25rem;
				font-weight: 600;
				margin: 0;
				color: rgb(var(--black));
				line-height: 1.4;
			}
			.resume-content :global(.project-card-description) {
				font-size: 0.95rem;
				color: rgb(var(--gray-dark));
				line-height: 1.6;
				margin: 0;
				flex: 1;
			}
			.resume-content :global(.project-card-tags) {
				display: flex;
				gap: 0.5rem;
				flex-wrap: wrap;
				margin-top: 0.5rem;
			}
			.resume-content :global(.project-card-tag) {
				padding: 0.25rem 0.75rem;
				background: rgba(79, 140, 255, 0.1);
				border: 1px solid var(--card-border);
				border-radius: 12px;
				font-size: 0.85rem;
				color: var(--accent);
			}
			.resume-content :global(.project-card-date) {
				font-size: 0.85rem;
				color: rgb(var(--gray));
				margin-top: 0.5rem;
				display: flex;
				align-items: center;
				gap: 0.5rem;
			}
			.resume-content :global(.project-card-date::before) {
				content: 'ğŸ“…';
				font-size: 1rem;
			}
			/* ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ì´ ìˆëŠ” divë„ ì§€ì› */
			.resume-content :global(div[style*="display: flex"]) {
				display: flex !important;
				gap: 2rem;
				align-items: flex-start;
				margin: 2rem 0;
			}
			.resume-content :global(div[style*="display: flex"] > div:first-child) {
				flex-shrink: 0;
			}
			.resume-content :global(div[style*="display: flex"] > div:last-child) {
				flex: 1;
			}
			.resume-content :global(a) {
				color: var(--accent);
				text-decoration: none;
				transition: color 0.3s ease;
			}
			.resume-content :global(a:hover) {
				color: var(--accent-glow);
				text-decoration: underline;
			}
			/* Profile ì„¹ì…˜ ìŠ¤íƒ€ì¼ - ì´ë¯¸ì§€ì™€ í…ìŠ¤íŠ¸ë¥¼ ë‚˜ë€íˆ ë°°ì¹˜ */
			.resume-content :global(h2:has(+ hr)) {
				margin-top: 1.75rem;
			}
			/* í”„ë¡œí•„ ì´ë¯¸ì§€ ë‹¤ìŒì— ì˜¤ëŠ” ì •ë³´ë“¤ì„ ê¹”ë”í•˜ê²Œ ì •ë¦¬ */
			/* í”„ë¡œí•„ ì •ë³´ ìŠ¤íƒ€ì¼ */
			.resume-content :global(p:has(strong)) {
				margin-top: 1.25rem;
				margin-bottom: 0.5rem;
			}
			.resume-content :global(p:has(strong) + p) {
				margin-top: 0;
				margin-bottom: 1.25rem;
			}
			/* Activities ì„¹ì…˜ ë‚ ì§œ ìŠ¤íƒ€ì¼ */
			.resume-content :global(p:not(:has(strong)):not(:has(a))) {
				margin: 0.5rem 0;
			}
			/* ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ì„¹ì…˜ */
			.download-section {
				display: flex;
				justify-content: center;
				margin-top: 3rem;
				padding-top: 2rem;
			}
			.download-button {
				display: flex;
				align-items: center;
				gap: 0.75rem;
				padding: 1rem 2rem;
				background: var(--accent);
				border: 1px solid var(--accent);
				border-radius: 12px;
				color: rgb(var(--black));
				font-size: 1rem;
				font-weight: 600;
				cursor: pointer;
				transition: all 0.3s ease;
				box-shadow: var(--neon-glow);
			}
			.download-button:hover {
				background: var(--accent-glow);
				transform: translateY(-2px);
				box-shadow: var(--neon-glow), 0 10px 30px rgba(79, 140, 255, 0.4);
			}
			.download-button:active {
				transform: translateY(0);
			}
			.download-button svg {
				flex-shrink: 0;
			}
			/* PDF ìƒì„±ìš© ìŠ¤íƒ€ì¼ */
			.resume-content.pdf-mode {
				box-shadow: none !important;
				border: none !important;
				border-radius: 0 !important;
				padding: 2rem !important;
				background: #0f1423 !important;
				max-width: 100% !important;
				width: 100% !important;
				text-align: left !important;
			}
			/* PDF ëª¨ë“œì—ì„œ í”„ë¡œì íŠ¸ ë ˆì´ì•„ì›ƒ - float ê¸°ë°˜ (PDF í˜¸í™˜ì„± í–¥ìƒ) */
			.resume-content.pdf-mode :global(.projects-container) {
				display: block !important;
				width: 100% !important;
				overflow: visible !important;
				margin: 2rem 0 !important;
				padding: 0 !important;
				box-sizing: border-box !important;
			}
			.resume-content.pdf-mode :global(.project-card) {
				page-break-inside: avoid !important;
				break-inside: avoid !important;
				box-sizing: border-box !important;
				display: block !important;
				position: relative !important;
				vertical-align: top !important;
			}
			.resume-content.pdf-mode :global(.project-card-image) {
				width: 100% !important;
				max-width: 100% !important;
				height: 200px !important;
				overflow: hidden !important;
				display: block !important;
			}
			.resume-content.pdf-mode :global(.project-card-image img) {
				width: 100% !important;
				height: 100% !important;
				object-fit: cover !important;
				display: block !important;
			}
			.resume-content.pdf-mode :global(.project-card-content) {
				width: 100% !important;
				max-width: 100% !important;
				box-sizing: border-box !important;
				display: flex !important;
				flex-direction: column !important;
			}
			.resume-content.pdf-mode :global(.project-card-title) {
				text-align: left !important;
			}
			.resume-content.pdf-mode :global(.project-card-description) {
				text-align: left !important;
			}
			.resume-content.pdf-mode :global(.project-card-tags) {
				display: flex !important;
				flex-wrap: wrap !important;
			}
			.resume-content.pdf-mode :global(*) {
				text-align: left !important;
			}
			.resume-content.pdf-mode :global(h1),
			.resume-content.pdf-mode :global(h2),
			.resume-content.pdf-mode :global(h3),
			.resume-content.pdf-mode :global(p),
			.resume-content.pdf-mode :global(li),
			.resume-content.pdf-mode :global(ul),
			.resume-content.pdf-mode :global(ol),
			.resume-content.pdf-mode :global(blockquote),
			.resume-content.pdf-mode :global(div) {
				text-align: left !important;
			}
			@media print {
				header, footer, .download-section {
					display: none !important;
				}
				.resume-content {
					box-shadow: none;
					border: none;
					padding: 2rem;
				}
			}
			@media (max-width: 1024px) {
				main {
					width: calc(100% - 4em) !important;
					max-width: calc(100% - 4em) !important;
					padding: 3rem 1.5em !important;
					margin-left: auto !important;
					margin-right: auto !important;
				}
				.resume-content {
					padding: 3rem 3rem;
					max-width: 100%;
					box-sizing: border-box;
					margin: 0 auto;
				}
			}
			@media (max-width: 720px) {
				main {
					width: calc(100% - 2em) !important;
					max-width: calc(100% - 2em) !important;
					padding: 2rem 1em !important;
					margin-left: auto !important;
					margin-right: auto !important;
				}
				.resume-content {
					padding: 2rem 2rem;
					border-radius: 16px;
					box-sizing: border-box;
					margin: 0 auto;
				}
				.resume-content :global(h1) {
					font-size: 2rem;
				}
				.resume-content :global(blockquote) {
					font-size: 1rem;
					margin: 1rem 0 2rem 0;
				}
				.resume-content :global(h2) {
					font-size: 1.3rem;
					margin: 1.5rem 0 0.75rem 0;
				}
				.resume-content :global(h3) {
					font-size: 1.1rem;
				}
				.resume-content :global(p) {
					font-size: 0.95rem;
				}
				.resume-content :global(li) {
					font-size: 0.95rem;
				}
				.resume-content :global(.profile-container),
				.resume-content :global(.activities-container),
				.resume-content :global(.activity-item),
				.resume-content :global(.projects-container) {
					grid-template-columns: 1fr !important;
				}
				.resume-content :global(.awards-container),
				.resume-content :global(.awards-item),
				.resume-content :global(.certifications-container),
				.resume-content :global(.certification-item),
				.resume-content :global(.educations-container),
				.resume-content :global(.education-item),
				.resume-content :global(.etc-container),
				.resume-content :global(.etc-item),
				.resume-content :global(.skills-container),
				.resume-content :global(div[style*="display: flex"]) {
					flex-direction: column !important;
					gap: 1.5rem;
				}
				.resume-content :global(.profile-image),
				.resume-content :global(div[style*="display: flex"] > div:first-child) {
					align-self: center;
				}
			}
			@media (max-width: 480px) {
				main {
					width: calc(100% - 1.5em) !important;
					max-width: calc(100% - 1.5em) !important;
					padding: 1.5rem 0.75em !important;
					margin-left: auto !important;
					margin-right: auto !important;
				}
				.resume-content {
					padding: 1.5rem 1.5rem;
					border-radius: 16px;
					box-sizing: border-box;
					margin: 0 auto;
				}
				.resume-content :global(h1) {
					font-size: 1.75rem;
				}
				.resume-content :global(blockquote) {
					font-size: 0.95rem;
				}
				.resume-content :global(h2) {
					font-size: 1.2rem;
					margin: 1.5rem 0 0.75rem 0;
				}
				.resume-content :global(h3) {
					font-size: 1rem;
				}
				.resume-content :global(p) {
					font-size: 0.9rem;
				}
				.resume-content :global(li) {
					font-size: 0.9rem;
				}
				.resume-content :global(img) {
					max-width: 200px;
				}
			}
		</style>
	</head>
	<body>
		<Header />
		<main>
			<div class="resume-content" id="resume-content">
				{Content ? <Content /> : <p>ì´ë ¥ì„œë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.</p>}
			</div>
			<div class="download-section">
				<button id="download-pdf" class="download-button">
					<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
						<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
						<polyline points="7 10 12 15 17 10"></polyline>
						<line x1="12" y1="15" x2="12" y2="3"></line>
					</svg>
					ë‹¤ìš´ë¡œë“œ
				</button>
			</div>
		</main>
		<Footer />
		<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
		<script define:vars={{ projects: projectsData }}>
			document.addEventListener('DOMContentLoaded', function() {
				// í”„ë¡œì íŠ¸ ëª©ë¡ ë Œë”ë§ (ì¹´ë“œ í˜•ì‹)
				const projectsContainer = document.getElementById('projects-container');
				if (projectsContainer && projects && projects.length > 0) {
					projectsContainer.innerHTML = projects.map(project => {
						const imageHtml = project.imageUrl 
							? `<div class="project-card-image"><img src="${project.imageUrl}" alt="${project.title}" /></div>`
							: '';
						
						const tagsHtml = project.tags && project.tags.length > 0
							? `<div class="project-card-tags">${project.tags.map(tag => `<span class="project-card-tag">${tag}</span>`).join('')}</div>`
							: '';
						
						// ê°œë°œ ê¸°ê°„ í‘œì‹œ (startDateì™€ endDateê°€ ìˆìœ¼ë©´ ì‚¬ìš©, ì—†ìœ¼ë©´ pubDate ì‚¬ìš©)
						let dateStr = '';
						if (project.startDate && project.endDate) {
							const startDate = new Date(project.startDate);
							const endDate = new Date(project.endDate);
							const formatDate = (date) => {
								const year = date.getFullYear();
								const month = String(date.getMonth() + 1).padStart(2, '0');
								const day = String(date.getDate()).padStart(2, '0');
								return `${year}-${month}-${day}`;
							};
							dateStr = `${formatDate(startDate)} ~ ${formatDate(endDate)}`;
						} else {
							const date = new Date(project.pubDate);
							dateStr = date.toLocaleDateString('ko-KR', { year: 'numeric', month: 'long', day: 'numeric' });
						}
						
						return `
							<a href="${project.url}" class="project-card">
								${imageHtml}
								<div class="project-card-content">
									<h3 class="project-card-title">${project.title}</h3>
									<p class="project-card-description">${project.description || ''}</p>
									<div class="project-card-date">${dateStr}</div>
									${tagsHtml}
								</div>
							</a>
						`;
					}).join('');
				}
				
				const downloadButton = document.getElementById('download-pdf');
				const resumeContent = document.getElementById('resume-content');
				
				if (downloadButton && resumeContent) {
					downloadButton.addEventListener('click', async function() {
						// ë²„íŠ¼ ë¹„í™œì„±í™”
						downloadButton.disabled = true;
						const originalHTML = downloadButton.innerHTML;
						downloadButton.innerHTML = '<span>PDF ìƒì„± ì¤‘...</span>';
						
						try {
							// ì´ë¯¸ì§€ ë¡œë”© ëŒ€ê¸° (ì´ë¯¸ ë¡œë“œëœ ì´ë¯¸ì§€ëŠ” ì¦‰ì‹œ í†µê³¼)
							const images = resumeContent.querySelectorAll('img');
							await Promise.all(
								Array.from(images).map(img => {
									if (img.complete && img.naturalHeight !== 0) return Promise.resolve();
									return new Promise((resolve) => {
										img.onload = resolve;
										img.onerror = resolve; // ì—ëŸ¬ê°€ ë‚˜ë„ ê³„ì† ì§„í–‰
										setTimeout(resolve, 2000); // ìµœëŒ€ 2ì´ˆ ëŒ€ê¸° (5ì´ˆ -> 2ì´ˆë¡œ ë‹¨ì¶•)
									});
								})
							);
							
							// main ìš”ì†Œì˜ ì‹¤ì œ ë„ˆë¹„ ê°€ì ¸ì˜¤ê¸° (resume.astroì˜ 1000px ì„¤ì • ë°˜ì˜)
							const mainElement = resumeContent.closest('main');
							let contentWidth = 1000; // ê¸°ë³¸ê°’: resume.astroì˜ max-width
							if (mainElement) {
								contentWidth = mainElement.offsetWidth || mainElement.clientWidth || 1000;
							}
							
							// PDF ëª¨ë“œ í´ë˜ìŠ¤ ì¶”ê°€ (ìŠ¤íƒ€ì¼ ë³´ì •ìš©)
							resumeContent.classList.add('pdf-mode');
							
							// í”„ë¡œì íŠ¸ ì»¨í…Œì´ë„ˆ ë ˆì´ì•„ì›ƒì€ í´ë¡ ëœ ë¬¸ì„œì—ì„œë§Œ ì ìš©í•˜ë„ë¡ ë³€ê²½
							// ì›ë³¸ ë¬¸ì„œëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€í•˜ì—¬ í™”ë©´ í‘œì‹œì— ì˜í–¥ ì—†ë„ë¡ í•¨
							
							// ì½˜í…ì¸  ë†’ì´ ê³„ì‚° (PDF ëª¨ë“œ ì ìš© í›„ ë ˆì´ì•„ì›ƒì´ ì™„ì „íˆ ì ìš©ë  ë•Œê¹Œì§€ ëŒ€ê¸°)
							await new Promise(resolve => setTimeout(resolve, 200));
							
							// ì—¬ëŸ¬ ë²ˆ í™•ì¸í•˜ì—¬ ì •í™•í•œ ë†’ì´ ê³„ì‚°
							let contentHeight = resumeContent.scrollHeight || resumeContent.offsetHeight;
							// í•œ ë²ˆ ë” í™•ì¸ (ë ˆì´ì•„ì›ƒì´ ì•ˆì •í™”ë  ë•Œê¹Œì§€)
							await new Promise(resolve => setTimeout(resolve, 50)); // 200ms -> 50msë¡œ ë‹¨ì¶•
							contentHeight = Math.max(contentHeight, resumeContent.scrollHeight || resumeContent.offsetHeight || 10000);
							// ETC ì„¹ì…˜ê¹Œì§€ í¬í•¨í•˜ê¸° ìœ„í•´ ì¶”ê°€ ì—¬ìœ  ê³µê°„ í™•ë³´
							contentHeight = contentHeight + 500; // ì¶©ë¶„í•œ ì—¬ìœ  ê³µê°„ ì¶”ê°€
							
							// PDF ì˜µì…˜ ì„¤ì •
							const opt = {
								margin: [15, 15, 15, 15],
								filename: 'ê¹€ëŒ€ì„±_ì´ë ¥ì„œ.pdf',
								image: { 
									type: 'jpeg', 
									quality: 0.85 // 0.95 -> 0.85ë¡œ ì¤„ì—¬ì„œ íŒŒì¼ í¬ê¸°ì™€ ì²˜ë¦¬ ì‹œê°„ ë‹¨ì¶•
								},
								html2canvas: { 
									scale: 1.5, // 2 -> 1.5ë¡œ ì¤„ì—¬ì„œ ì†ë„ í–¥ìƒ (í’ˆì§ˆì€ ì•½ê°„ ë–¨ì–´ì§€ì§€ë§Œ ì¶©ë¶„íˆ ì„ ëª…)
									useCORS: true,
									allowTaint: false,
									letterRendering: false, // true -> falseë¡œ ë³€ê²½í•˜ì—¬ ì†ë„ í–¥ìƒ
									backgroundColor: '#0f1423',
									width: contentWidth,
									height: contentHeight, // ì´ë¯¸ ìœ„ì—ì„œ ì—¬ìœ  ê³µê°„ì´ ì¶”ê°€ë¨
									windowWidth: contentWidth,
									windowHeight: contentHeight, // ì´ë¯¸ ìœ„ì—ì„œ ì—¬ìœ  ê³µê°„ì´ ì¶”ê°€ë¨
									x: 0,
									y: 0,
									scrollX: 0,
									scrollY: 0,
									logging: false,
									onclone: function(clonedDoc) {
										// í´ë¡ ëœ ë¬¸ì„œì˜ html, body ìŠ¤íƒ€ì¼ ìˆ˜ì •
										const clonedHtml = clonedDoc.documentElement;
										const clonedBody = clonedDoc.body;
										
										if (clonedHtml) {
											clonedHtml.style.margin = '0';
											clonedHtml.style.padding = '0';
											clonedHtml.style.textAlign = 'left';
										}
										
										if (clonedBody) {
											clonedBody.style.margin = '0';
											clonedBody.style.padding = '0';
											clonedBody.style.textAlign = 'left';
											clonedBody.style.width = '100%';
											clonedBody.style.maxWidth = '100%';
											clonedBody.style.overflow = 'visible';
										}
										
										// í´ë¡ ëœ ë¬¸ì„œì˜ main ìš”ì†Œ ì œê±° ë˜ëŠ” ìŠ¤íƒ€ì¼ ìˆ˜ì •
										const clonedMain = clonedDoc.querySelector('main');
										if (clonedMain) {
											clonedMain.style.margin = '0';
											clonedMain.style.padding = '0';
											clonedMain.style.width = 'auto';
											clonedMain.style.maxWidth = 'none';
											clonedMain.style.textAlign = 'left';
										}
										
										// í´ë¡ ëœ ë¬¸ì„œì—ì„œ ìŠ¤íƒ€ì¼ ë³´ì •
										const clonedContent = clonedDoc.getElementById('resume-content');
										if (clonedContent) {
											// PDFìš© ìŠ¤íƒ€ì¼ ì ìš© - resume.astroì˜ 1000px ì„¤ì • ë°˜ì˜
											clonedContent.style.width = contentWidth + 'px';
											clonedContent.style.maxWidth = contentWidth + 'px';
											clonedContent.style.minWidth = contentWidth + 'px';
											clonedContent.style.height = 'auto';
											clonedContent.style.minHeight = 'auto';
											clonedContent.style.maxHeight = 'none';
											clonedContent.style.overflow = 'visible';
											clonedContent.style.boxShadow = 'none';
											clonedContent.style.border = 'none';
											clonedContent.style.borderRadius = '0';
											clonedContent.style.padding = '2rem';
											clonedContent.style.paddingBottom = '8rem'; // í•˜ë‹¨ ì—¬ìœ  ê³µê°„ ì¦ê°€ (ETC ì„¹ì…˜ í¬í•¨)
											clonedContent.style.background = '#0f1423';
											clonedContent.style.margin = '0 auto';
											clonedContent.style.marginLeft = 'auto';
											clonedContent.style.marginRight = 'auto';
											clonedContent.style.textAlign = 'left';
											clonedContent.style.display = 'block';
											
											// ëª¨ë“  ì´ë¯¸ì§€ê°€ ë¡œë“œë˜ì—ˆëŠ”ì§€ í™•ì¸
											const imgs = clonedContent.querySelectorAll('img');
											imgs.forEach(img => {
												img.style.maxWidth = '100%';
												img.style.height = 'auto';
												img.style.display = 'block';
											});
											
											// ëª¨ë“  í…ìŠ¤íŠ¸ ìš”ì†Œì˜ text-alignì„ leftë¡œ ì„¤ì •
											const textElements = clonedContent.querySelectorAll('h1, h2, h3, h4, h5, h6, p, li, ul, ol, blockquote, div, span, a, strong, em');
											textElements.forEach(el => {
												el.style.textAlign = 'left';
												el.style.transform = 'none';
												el.style.transition = 'none';
											});
											
											// ëª¨ë“  ìš”ì†Œì˜ transformê³¼ transition ì œê±°
											const allElements = clonedContent.querySelectorAll('*');
											allElements.forEach(el => {
												if (!el.style.textAlign) {
													el.style.textAlign = 'left';
												}
												el.style.transform = 'none';
												el.style.transition = 'none';
											});
											
											// í”„ë¡œì íŠ¸ ì»¨í…Œì´ë„ˆì— 2ì—´ ë ˆì´ì•„ì›ƒ ì ìš© (PDF í˜¸í™˜ì„± í–¥ìƒ)
											const projectsContainer = clonedContent.querySelector('.projects-container');
											if (projectsContainer) {
												// ì»¨í…Œì´ë„ˆì˜ ì‹¤ì œ ë„ˆë¹„ ê³„ì‚° (padding 2rem = 32px ì œì™¸)
												const padding = 32; // 2rem = 32px
												const containerWidth = contentWidth - (padding * 2); // ì–‘ìª½ padding ì œì™¸
												const gap = 24; // 1.5rem = 24px
												const cardWidth = Math.floor((containerWidth - gap) / 2); // 2ì—´ ë ˆì´ì•„ì›ƒ
												
												// ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ ì„¤ì •
												projectsContainer.style.display = 'block';
												projectsContainer.style.width = '100%';
												projectsContainer.style.maxWidth = '100%';
												projectsContainer.style.overflow = 'visible';
												projectsContainer.style.margin = '2rem 0';
												projectsContainer.style.padding = '0';
												projectsContainer.style.boxSizing = 'border-box';
												
												// ê¸°ì¡´ clearfix ì œê±°
												const existingClearfix = projectsContainer.querySelector('.pdf-clearfix');
												if (existingClearfix) {
													existingClearfix.remove();
												}
												
												// í”„ë¡œì íŠ¸ ì¹´ë“œ ìŠ¤íƒ€ì¼ ìˆ˜ì • - ë” ì •í™•í•œ ë ˆì´ì•„ì›ƒ ì ìš©
												const projectCards = Array.from(projectsContainer.querySelectorAll('.project-card'));
												projectCards.forEach((card, index) => {
													// ëª¨ë“  ê¸°ë³¸ ìŠ¤íƒ€ì¼ ì œê±° í›„ ì¬ì„¤ì •
													card.style.cssText = '';
													
													// floatë¥¼ ì‚¬ìš©í•œ 2ì—´ ë ˆì´ì•„ì›ƒ
													card.style.float = index % 2 === 0 ? 'left' : 'right';
													card.style.width = cardWidth + 'px';
													card.style.maxWidth = cardWidth + 'px';
													card.style.minWidth = cardWidth + 'px';
													card.style.marginLeft = '0';
													card.style.marginRight = index % 2 === 0 ? gap + 'px' : '0';
													card.style.marginTop = '0';
													card.style.marginBottom = gap + 'px';
													card.style.display = 'block';
													card.style.pageBreakInside = 'avoid';
													card.style.breakInside = 'avoid';
													card.style.boxSizing = 'border-box';
													card.style.position = 'relative';
													card.style.verticalAlign = 'top';
													
													// ì¹´ë“œ ë°°ê²½ ë° í…Œë‘ë¦¬
													card.style.background = 'rgba(15, 20, 35, 0.6)';
													card.style.border = '1px solid rgba(79, 140, 255, 0.2)';
													card.style.borderRadius = '20px';
													card.style.overflow = 'hidden';
													card.style.textDecoration = 'none';
													card.style.color = 'inherit';
													
													// ì¹´ë“œ ë‚´ë¶€ ì´ë¯¸ì§€ ìš”ì†Œ ì¡°ì •
													const cardImage = card.querySelector('.project-card-image');
													if (cardImage) {
														cardImage.style.width = '100%';
														cardImage.style.maxWidth = '100%';
														cardImage.style.height = '200px';
														cardImage.style.overflow = 'hidden';
														cardImage.style.background = 'rgba(15, 20, 35, 0.6)';
														cardImage.style.display = 'block';
														
														const cardImg = cardImage.querySelector('img');
														if (cardImg) {
															cardImg.style.width = '100%';
															cardImg.style.height = '100%';
															cardImg.style.objectFit = 'cover';
															cardImg.style.display = 'block';
														}
													}
													
													// ì¹´ë“œ ë‚´ë¶€ ì½˜í…ì¸  ìš”ì†Œ ì¡°ì •
													const cardContent = card.querySelector('.project-card-content');
													if (cardContent) {
														cardContent.style.width = '100%';
														cardContent.style.maxWidth = '100%';
														cardContent.style.padding = '1.5rem';
														cardContent.style.display = 'flex';
														cardContent.style.flexDirection = 'column';
														cardContent.style.gap = '0.75rem';
														cardContent.style.boxSizing = 'border-box';
													}
													
													// ì¹´ë“œ ì œëª© ìŠ¤íƒ€ì¼
													const cardTitle = card.querySelector('.project-card-title');
													if (cardTitle) {
														cardTitle.style.fontSize = '1.25rem';
														cardTitle.style.fontWeight = '600';
														cardTitle.style.margin = '0';
														cardTitle.style.color = 'rgb(245, 247, 250)';
														cardTitle.style.lineHeight = '1.4';
													}
													
													// ì¹´ë“œ ì„¤ëª… ìŠ¤íƒ€ì¼
													const cardDescription = card.querySelector('.project-card-description');
													if (cardDescription) {
														cardDescription.style.fontSize = '0.95rem';
														cardDescription.style.color = 'rgb(200, 205, 215)';
														cardDescription.style.lineHeight = '1.6';
														cardDescription.style.margin = '0';
													}
													
													// ì¹´ë“œ íƒœê·¸ ìŠ¤íƒ€ì¼
													const cardTags = card.querySelector('.project-card-tags');
													if (cardTags) {
														cardTags.style.display = 'flex';
														cardTags.style.gap = '0.5rem';
														cardTags.style.flexWrap = 'wrap';
														cardTags.style.marginTop = '0.5rem';
													}
													
													const cardTagItems = card.querySelectorAll('.project-card-tag');
													cardTagItems.forEach(tag => {
														tag.style.padding = '0.25rem 0.75rem';
														tag.style.background = 'rgba(79, 140, 255, 0.1)';
														tag.style.border = '1px solid rgba(79, 140, 255, 0.2)';
														tag.style.borderRadius = '12px';
														tag.style.fontSize = '0.85rem';
														tag.style.color = '#4f8cff';
													});
													
													// ì¹´ë“œ ë‚ ì§œ ìŠ¤íƒ€ì¼
													const cardDate = card.querySelector('.project-card-date');
													if (cardDate) {
														cardDate.style.fontSize = '0.85rem';
														cardDate.style.color = 'rgb(130, 145, 170)';
														cardDate.style.marginTop = '0.5rem';
													}
												});
												
												// clearfix ì¶”ê°€ (ë§ˆì§€ë§‰ ìš”ì†Œ ì´í›„)
												const clearDiv = clonedDoc.createElement('div');
												clearDiv.className = 'pdf-clearfix';
												clearDiv.style.clear = 'both';
												clearDiv.style.width = '100%';
												clearDiv.style.height = '0';
												clearDiv.style.display = 'block';
												projectsContainer.appendChild(clearDiv);
											}
										}
									}
								},
								jsPDF: { 
									unit: 'mm', 
									format: 'a4', 
									orientation: 'portrait',
									compress: true
								},
								pagebreak: { 
									mode: ['css', 'legacy'],
									before: '.page-break-before',
									after: '.page-break-after',
									avoid: ['img', '.profile-container', '.activity-item', '.awards-item', '.certification-item', '.education-item', '.etc-item', '.etc-container']
								}
							};
							
							// PDF ìƒì„± ë° ë‹¤ìš´ë¡œë“œ
							await html2pdf()
								.set(opt)
								.from(resumeContent)
								.save();
							
							// PDF ëª¨ë“œ í´ë˜ìŠ¤ ì œê±°
							resumeContent.classList.remove('pdf-mode');
							
							// ì™„ë£Œ í›„ ë²„íŠ¼ ë³µì›
							downloadButton.disabled = false;
							downloadButton.innerHTML = originalHTML;
						} catch (error) {
							console.error('PDF ìƒì„± ì˜¤ë¥˜:', error);
							// PDF ëª¨ë“œ í´ë˜ìŠ¤ ì œê±°
							if (resumeContent) {
								resumeContent.classList.remove('pdf-mode');
							}
							alert('PDF ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
							downloadButton.disabled = false;
							downloadButton.innerHTML = originalHTML;
						}
					});
				}
			});
		</script>
	</body>
</html>
